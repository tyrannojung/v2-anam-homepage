<config autoescape="on" />

<include target="config_header.html" />

<div cond="!empty($XE_VALIDATOR_MESSAGE) && $XE_VALIDATOR_ID == 'modules/admin/tpl/config_security/1'" class="message {$XE_VALIDATOR_MESSAGE_TYPE}">
	<p>{$XE_VALIDATOR_MESSAGE}</p>
</div>
<section class="section">
	<form action="./" method="post" class="x_form-horizontal">
		<input type="hidden" name="module" value="admin" />
		<input type="hidden" name="act" value="procAdminUpdateSecurity" />
		<input type="hidden" name="xe_validator_id" value="modules/admin/tpl/config_security/1" />
		<div class="x_control-group">
			<label class="x_control-label" for="mediafilter_whitelist">{$lang->mediafilter_whitelist}</label>
			<div class="x_controls">
				<textarea name="mediafilter_whitelist" id="mediafilter_whitelist" rows="8" class="x_full-width">{$mediafilter_whitelist}</textarea>
				<p class="x_help-block">{$lang->about_mediafilter_whitelist}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label" for="mediafilter_classes">{$lang->mediafilter_classes}</label>
			<div class="x_controls">
				<textarea name="mediafilter_classes" id="mediafilter_classes" rows="4" class="x_full-width">{$mediafilter_classes}</textarea>
				<p class="x_help-block">{$lang->about_mediafilter_classes}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label" for="robot_user_agents">{$lang->robot_user_agents}</label>
			<div class="x_controls">
				<textarea name="robot_user_agents" id="robot_user_agents" rows="4" class="x_full-width">{$robot_user_agents}</textarea>
				<p class="x_help-block">{$lang->about_robot_user_agents}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label" for="admin_allowed_ip">{$lang->admin_ip_allow}</label>
			<div class="x_controls">
				<textarea name="admin_allowed_ip" id="admin_allowed_ip" rows="4" cols="42" placeholder="{$remote_addr} ({$lang->local_ip_address})" style="margin-right:10px">{$admin_allowed_ip}</textarea>
				<p class="x_help-block">{$lang->about_admin_ip_allow}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label" for="admin_denied_ip">{$lang->admin_ip_deny}</label>
			<div class="x_controls">
				<textarea name="admin_denied_ip" id="admin_denied_ip" rows="4" cols="42" style="margin-right:10px">{$admin_denied_ip}</textarea>
				<p class="x_help-block">{$lang->about_admin_ip_deny}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label" for="autologin_lifetime">{$lang->autologin_lifetime}</label>
			<div class="x_controls">
				<input type="number" name="autologin_lifetime" min="1" max="400" value="{$autologin_lifetime}" /> {$lang->unit_day} &nbsp;
				<label for="autologin_refresh" class="x_inline"><input type="checkbox" name="autologin_refresh" id="autologin_refresh" value="Y" checked="checked"|cond="$autologin_refresh" /> {$lang->autologin_refresh}</label>
				<br />
				<p class="x_help-block">{$lang->about_autologin_lifetime}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">{$lang->use_session_ssl}</label>
			<div class="x_controls">
				<label for="use_session_ssl_y" class="x_inline"><input type="radio" name="use_session_ssl" id="use_session_ssl_y" value="Y" checked="checked"|cond="$use_session_ssl && $site_module_info->security === 'always'" disabled="disabled"|cond="$site_module_info->security !== 'always'" /> {$lang->cmd_yes}</label>
				<label for="use_session_ssl_n" class="x_inline"><input type="radio" name="use_session_ssl" id="use_session_ssl_n" value="N" checked="checked"|cond="!$use_session_ssl || $site_module_info->security !== 'always'" disabled="disabled"|cond="$site_module_info->security !== 'always'" /> {$lang->cmd_no}</label>
				<br />
				<p class="x_help-block">{$lang->about_use_session_ssl}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">{$lang->use_cookies_ssl}</label>
			<div class="x_controls">
				<label for="use_cookies_ssl_y" class="x_inline"><input type="radio" name="use_cookies_ssl" id="use_cookies_ssl_y" value="Y" checked="checked"|cond="$use_cookies_ssl && $site_module_info->security === 'always'" disabled="disabled"|cond="$site_module_info->security !== 'always'" /> {$lang->cmd_yes}</label>
				<label for="use_cookies_ssl_n" class="x_inline"><input type="radio" name="use_cookies_ssl" id="use_cookies_ssl_n" value="N" checked="checked"|cond="!$use_cookies_ssl || $site_module_info->security !== 'always'" disabled="disabled"|cond="$site_module_info->security !== 'always'" /> {$lang->cmd_no}</label>
				<br />
				<p class="x_help-block">{$lang->about_use_cookies_ssl}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">{$lang->check_csrf_token}</label>
			<div class="x_controls">
				<label for="check_csrf_token_y" class="x_inline"><input type="radio" name="check_csrf_token" id="check_csrf_token_y" value="Y" checked="checked"|cond="$check_csrf_token" /> {$lang->cmd_yes}</label>
				<label for="check_csrf_token_n" class="x_inline"><input type="radio" name="check_csrf_token" id="check_csrf_token_n" value="N" checked="checked"|cond="!$check_csrf_token" /> {$lang->cmd_no}</label>
				<br />
				<p class="x_help-block">{$lang->about_check_csrf_token}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">{$lang->use_nofollow}</label>
			<div class="x_controls">
				<label for="use_nofollow_y" class="x_inline"><input type="radio" name="use_nofollow" id="use_nofollow_y" value="Y" checked="checked"|cond="$use_nofollow" /> {$lang->cmd_yes}</label>
				<label for="use_nofollow_n" class="x_inline"><input type="radio" name="use_nofollow" id="use_nofollow_n" value="N" checked="checked"|cond="!$use_nofollow" /> {$lang->cmd_no}</label>
				<br />
				<p class="x_help-block">{$lang->about_use_nofollow}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">{$lang->use_httponly}</label>
			<div class="x_controls">
				<label for="use_httponly_y" class="x_inline"><input type="radio" name="use_httponly" id="use_httponly_y" value="Y" checked="checked"|cond="$use_httponly !== false" /> {$lang->cmd_yes}</label>
				<label for="use_httponly_n" class="x_inline"><input type="radio" name="use_httponly" id="use_httponly_n" value="N" checked="checked"|cond="$use_httponly === false" /> {$lang->cmd_no}</label>
				<br />
				<p class="x_help-block">{$lang->about_use_httponly}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">{$lang->use_samesite}</label>
			<div class="x_controls">
				<label for="use_samesite_strict" class="x_inline"><input type="radio" name="use_samesite" id="use_samesite_strict" value="Strict" checked="checked"|cond="$use_samesite === 'Strict'" /> Strict</label>
				<label for="use_samesite_lax" class="x_inline"><input type="radio" name="use_samesite" id="use_samesite_lax" value="Lax" checked="checked"|cond="$use_samesite === 'Lax'" /> Lax</label>
				<label for="use_samesite_none" class="x_inline"><input type="radio" name="use_samesite" id="use_samesite_none" value="None" checked="checked"|cond="$use_samesite === 'None'" disabled="disabled"|cond="!$use_session_ssl || $site_module_info->security !== 'always'" /> None</label>
				<label for="use_samesite_empty" class="x_inline"><input type="radio" name="use_samesite" id="use_samesite_empty" value="" checked="checked"|cond="!$use_samesite" /> {$lang->use_samesite_empty}</label>
				<br />
				<p class="x_help-block">{$lang->about_use_samesite}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">X-Frame-Options</label>
			<div class="x_controls">
				<label for="x_frame_options_deny" class="x_inline"><input type="radio" name="x_frame_options" id="x_frame_options_deny" value="DENY" checked="checked"|cond="$x_frame_options === 'DENY'" /> Deny</label>
				<label for="x_frame_options_sameorigin" class="x_inline"><input type="radio" name="x_frame_options" id="x_frame_options_sameorigin" value="SAMEORIGIN" checked="checked"|cond="$x_frame_options === 'SAMEORIGIN'" /> SameOrigin</label>
				<label for="x_frame_options_empty" class="x_inline"><input type="radio" name="x_frame_options" id="x_frame_options_empty" value="" checked="checked"|cond="!$x_frame_options" /> {$lang->use_samesite_empty}</label>
				<br />
				<p class="x_help-block">{$lang->about_x_frame_options}</p>
			</div>
		</div>
		<div class="x_control-group">
			<label class="x_control-label">X-Content-Type-Options</label>
			<div class="x_controls">
				<label for="x_content_type_options_nosniff" class="x_inline"><input type="radio" name="x_content_type_options" id="x_content_type_options_nosniff" value="nosniff" checked="checked"|cond="$x_content_type_options === 'nosniff'" /> nosniff</label>
				<label for="x_content_type_options_empty" class="x_inline"><input type="radio" name="x_content_type_options" id="x_content_type_options_empty" value="" checked="checked"|cond="!$x_content_type_options" /> {$lang->use_samesite_empty}</label>
				<br />
				<p class="x_help-block">{$lang->about_x_content_type_options}</p>
			</div>
		</div>
		<div class="x_clearfix btnArea">
			<div class="x_pull-right">
				<button type="submit" class="x_btn x_btn-primary">{$lang->cmd_save}</button>
			</div>
		</div>
	</form>
</section>
